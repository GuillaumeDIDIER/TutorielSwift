\chapter{Les variables et constantes}
Comme je l'ai dit, un ordinateur manipule des données. Il faut donc pouvoir les stocker
quelque part.
\section{La mémoire d'un ordinateur, qu'est-ce qu'une \emph{variable} ?}
Une \emph{variable}, c'est avant tout un compartiment de la mémoire de l'ordinateur sur lequel on colle un nom, et dans lequel on a le droit de mettre ce que l'on veut, pour pouvoir y accéder ultérieurement.

L'unité de base de la mémoire d'un ordinateur est \emph{le} bit (pas la !), qui possède deux états,
1 ou 0, à comparer aux 10 chiffres de notre système décimal.

Pour stocker des nombres
plus grand, il faut mettre plusieurs bits cote à cote, comme nous mettons plusieurs chiffres
pour écrire 1999, par exemple. Dans ce cas, le dernier chiffre correspond aux unités, l'avant dernier à
des paquets de 2, l'antépénultième 4, ... 8, 16, 32, 64... .

Les bits sont regroupés en mots
appelés \emph{bytes} en anglais, d'une taille fixée par l'architecture du processeur. En français
on traduit improprement ce terme par octet, qui désigne un mot/byte de 8 bit qui peut prendre
\begin{math}2*2*2...*2\end{math} huit fois, noté \begin{math} 2^{8} \end{math}. Soit 256 valeurs (retenez ce nombre, on le retrouvera par la suite.)
Toute la mémoire est découpé en bytes. On manipule forcément un ensemble de byte. (1,
2, 4, ...), et donc toute variable a une taille définie qui est un multiple de l'octet.

L'ordinateur peut aussi stocker des nombres binaires à virgule, comme nos nombres à virgule, avec les limitations de ces derniers. Je ne détaille pas ici toute la représentation, si vous voulez des details je vous renvoie à cet excellent \TSwiftUrl{http://openclassrooms.com/courses/fonctionnement-d-un-ordinateur-depuis-zero}{tutoriel}{Fonctionnement d'un ordinateur à partir de zéro --- OpenClassrooms}.

\url

\emph{Mais il n'y a que des nombres, comment on stocke du texte ?!}
Désolé, mais pour l'ordinateur, tout est un nombre, tout dépend de la façon dont on
l'interprète, on y viendra un peu plus tard.
\section{Demander poliment de la place pour stocker un nombre}
Passons à la pratique !
\subsection{Déclarons l'age du Capitaine}
\begin{listing}[h]
\caption{Premier exemple, l'age du Capitaine}
\begin{minted}[linenos=true]{swift}
var age_du_capitaine = 42 // ;-)
\end{minted}
\end{listing}
Décortiquons ce qui précède :
\begin{description}
\item[var :] Mot \emph{clé} indiquant que l'on veut déclarer une variable.
\item[age\_du\_capitaine :] Nom de la variable, qui nous permettra d'y accéder de nouveau. \emph{Attention, il ne peut pas y avoir deux variables de même nom}
\item[= :] Opérateur utilisé pour doner une valeur à une variable.
\item[42 :] La valeur entière que l'on donne à notre variable.
\item[// ;-) :] C'est un commentaire. Si vous ne le saviez pas, \emph{relisez le chapitre précédent}.
\end{description}
Avertissement, ne mettez pas de zéro suivi de chiffres non nuls, car vous auriez des surprises (octale). (Je reviendrait la dessus dans un chapitre ultérieur.)
\subsection{Différents types d'entiers}
Je vous ai parlé de la représentation en mémoire des entiers, donc vous devriez me demander comment Swift détermine le nombres d'octets qui sont attribués à notre entier. La réponse c'est qu'il a attend qu'on  le lui précise, ou il prend une valeur par défaut.
Il existe donc plusieurs type d'entiers, chacun pouvant contenir une plage de nombre particulière. Notamment, il existe des variantes non signées, qui ne contienne que des nombres positifs.

\begin{longtabu} to \linewidth {|X[3,l,m]|X[1.5,l,m]|X[6,r,m]|X[1,r,m]|}
\hline Taille & Type & Plage de valeur & Précision \\ \hline
\endhead
\input{\TSwiftRoot/Reference/Types/Integer}
\caption{Les différents Types d'entiers}
\end{longtabu}

Attention, n'essayez pas de mélanger des types différents ou le compilateur vous fera amèrement regretter. On discutera de ce problème un peu plus en détail dans la quatrième section.

Par exemple pour déclarer que l'on stocke l'age du Capitaine sur 1 octet (soit 8 bit) et que ce doit être un entier non signé (positif) on utilise :

\begin{listing}[h]
\caption{Un type plus approprié pour l'age du capitaine}
\begin{minted}[linenos]{swift}
var age_du_pitaine : UInt8  = 42 // Question ? Quel est l'age maximal du capitaine
\end{minted}
\end{listing}
Le caractère \verb":" permet d'introduire une \emph{annotation de type}, tandis que \verb"UInt8" correspond au type d'entier choisi.

Remarquez que Swift est ici plutôt agréable à utiliser puisqu'il ne nous oblige pas à lui préciser le type lorsque la réponse est évidente, mais nous permet d'être plus précis si on en a besoin.
\subsection{La structure générale}
La structure générale est la suivante, ou les parties entre crochets peuvent être absente, mais pas toute les deux.
\begin{listing}[h]
\begin{minted}[linenos]{swift}
var <nom de variable> [ : <Type> ] [ = <valeur initiale> ]
\end{minted}
\caption{Structure générale d'une déclaration de variable}
\end{listing}
\begin{description}
\item[nom de variable :] Un nom de variable peut être composé de n'importe quel caractère unicode à part les espaces, les flèches et symboles mathématiques et les caractères Unicode invalides ou servant à dessiner des lignes et des boites, soit à peu près tout ce que vous puvez vouloir utiliser. Il ne doit pas commencer par un chiffre.
\item[Type :] Il peut être omis si une valeur initiale est précisée, permettant à Swift de déduire le Type.
Le mot clé \mintinline{swift}{typealias} permet de définir un type comme étant la même chose qu'un type déja existant (Les noms de types suivent les même règles que les noms de variable). Exemple \mint{swift}|typealias Age = UInt8|
\emph{Toute variable possède un type.}
\item[valeur initiale :] Il est recommandé d'initialiser une variable à sa déclaration, mais ce n'est pas obligatoire, dans ce cas il est indispensable de préciser le type pour que Swift s'y retrouve. Dans ce cas il faut aussi garantir que la variable sera toujours initialisée avant d'y accéder pour la première fois, sinon le programme ne compilera pas.
\end{description}
Il est possible de déclarer plusieurs variables en même temps, exemple :
\mint{swift}|var frères = 5, sœurs = 4 // c'est une famille nombreuse !|
\subsection{Les nombres à virgule flottante}
Parlons maintenant des nombres à virgule (ou à points, puisque tel est le séparateur décimal en Angleterre et donc dans le monde des programmeurs).
Ces nombres ont un défaut, il ne peuvent pas représenter parfaitement tous les nombres décimaux, comme un nombre décimal ne peu pas représenter parfaitement \begin{math} \frac{1}{7} \end{math}, par exemple. Mais en général cette approximation n'est pas un problème.
Il y deux principaux types de nombres à virgule, ainsi qu'un troisième, moins commun, que je cite par soucis d'exhaustivité :
\begin{longtabu} to \linewidth {|X[3,l,m]|X[1,l,m]|X[4,r,m]|X[3,r,m]|}
\hline Taille & Type & Plage de valeur (approximative) & Précision \\ \hline
\endhead
\input{\TSwiftRoot/Reference/Types/Float}
\caption{Les différents Types de nombres à virgule flottante}
\end{longtabu}

Il est aussi possible d'insérer des \_ entre les chiffres, pour formatter ses nombres de manière plus (ou moins, au choix) lisible.

\subsection{Changer la valeur d'une variable}
Pour changer la valeur d'une variable il suffit d'utiliser l'opérateur \verb"=".
\begin{listing}[h]
\caption{Un type plus approprié pour l'age du capitaine}
\begin{minted}[linenos]{swift}
var sens_de_la_vie = 5 // Int
sens_de_la_vie = 42 // Parce que c'est la seule bonne réponse !
var six_fois_sept = sens_de_la_vie // ça marche aussi.
var pi = 3.14 // Double
pi = 3.141592 // Plus précis !
\end{minted}
\end{listing}

\emph{Attention, on ne peut pas changer le type d'une variable après qu'elle est été défini.}
\subsection{Récapitulatif des types de nombres}
\begin{longtabu} to \linewidth {|X[2,l,m]|X[1,l,m]|X[4,r,m]|X[2,r,m]|}
\hline Taille & Type & Plage de valeur (approximative) & Précision \\ \hline
\endhead
\input{\TSwiftRoot/Reference/Types/Integer}
\input{\TSwiftRoot/Reference/Types/Float}
\caption{Les différents types de nombres}
\end{longtabu}
Notez aussi que les nombres littéraux, que vous tapez n'ont pas de type a priori, et que le type résultant n'est déterminé qu'après comme étant Int ou Double, si le résultat n'est pas entier. Il existe plusieurs notations(décimale, hexadécimale, octale, binaire), mais je ne vous les présente pas ici.
\section{Variables et Constantes}
On peut en fait imposer que la valeur d'une variable ne change plus après sa création :
c'est alors une constante. Elle se déclare comme une variable excepté que l'on utilise le
mot clé \mintinline{swift}{let}, et que sa valeur doit être fixé à la déclaration, dans ce cas toute tentative de changement de la valeur résulte en une erreur à la compilation.
\begin{listing}[h]
\begin{minted}[linenos=true]{swift}
let pi = 3.141592
// Que personne n'essaye de changer pi !
pi = 3.1416 // Erreur !
\end{minted}
\end{listing}

Du fait de cette déclaration, le compilateur peut d'une part vous prémunir d'une erreur, et
d'autre part réaliser des optimisations supplémentaires. Apple vous recommande d'utiliser
des constantes en priorité, et de ne déclarer comme variable que ce qui doit l'être.
